<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>íƒœì–‘ê³„ì •ë³µ - ë©”ì¸ ë©”ë‰´</title>
  <meta name="description" content="íƒœì–‘ê³„ì •ë³µ - ìš°ì£¼ ìƒì¡´ í´ë¦­ì»¤. ì§ê´€ì ì¸ ì¡°ì‘ê³¼ í™”ë ¤í•œ ê·¸ë˜í”½ì˜ HTML ê²Œì„ì…ë‹ˆë‹¤. ì§€ê¸ˆ íŒì—…ìœ¼ë¡œ ê²Œì„ì„ ì‹¤í–‰í•˜ì„¸ìš”.">
  <meta name="keywords" content="íƒœì–‘ê³„, ìš°ì£¼, í´ë¦­ì»¤, HTML ê²Œì„, SIU Studio">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="./">

  <!-- Open Graph -->
  <meta property="og:title" content="íƒœì–‘ê³„ì •ë³µ - SIU Studio">
  <meta property="og:description" content="ì§ê´€ì ì¸ ì¡°ì‘ê³¼ í™”ë ¤í•œ ê·¸ë˜í”½ì˜ ìš°ì£¼ ìƒì¡´ í´ë¦­ì»¤. ì§€ê¸ˆ íŒì—…ìœ¼ë¡œ ê²Œì„ì„ ì‹¤í–‰í•˜ì„¸ìš”.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="space-bg.jpg">
  <meta property="og:image:alt" content="íƒœì–‘ê³„ì •ë³µ ì¸ë„¤ì¼">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="íƒœì–‘ê³„ì •ë³µ - SIU Studio">
  <meta name="twitter:description" content="ì§ê´€ì ì¸ ì¡°ì‘ê³¼ í™”ë ¤í•œ ê·¸ë˜í”½ì˜ ìš°ì£¼ ìƒì¡´ í´ë¦­ì»¤. ì§€ê¸ˆ íŒì—…ìœ¼ë¡œ ê²Œì„ì„ ì‹¤í–‰í•˜ì„¸ìš”.">
  <meta name="twitter:image" content="space-bg.jpg">

  <!-- Icons -->
  <link rel="icon" href="space-bg.jpg" type="image/jpeg">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="icon" href="/favicon.ico?v=2" type="image/x-icon">

  <!-- PWA -->
  <link rel="manifest" href="/site.webmanifest">
  <meta name="msapplication-TileColor" content="#2d89ef">
  <meta name="theme-color" content="#ffffff">

  <script>
    try { history.replaceState(null, '', '/main' + (location.hash || '')); }
    catch(e){ console.warn('ì£¼ì†Œ í‘œì‹œ ë³€ê²½ ì‹¤íŒ¨:', e); }
  </script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { height: 100%; font-family: 'Orbitron', sans-serif; background: #000; }
    .container { display: flex; flex-direction: row; height: 100vh; }
    .sidebar {
      width: 250px;
      background: rgba(10, 10, 30, 0.8);
      display: flex; flex-direction: column; align-items: center;
      padding-top: 40px; gap: 20px;
      box-shadow: 5px 0 15px rgba(0,0,0,0.5);
      z-index: 3;
    }
    .sidebar button {
      width: 80%; padding: 12px 0; text-align: center; text-decoration: none;
      color: #fff; background: rgba(255,255,255,0.1); border: none; border-radius: 30px;
      cursor: pointer; transition: background 0.3s, transform 0.2s;
    }
    .sidebar button:hover { background: rgba(244,180,0,0.8); transform: scale(1.05); color: #000; }

    .content { flex: 1; position: relative; background: url('background.jpg') center/cover no-repeat; }
    .content::after { content: ''; position: absolute; inset: 0; background: radial-gradient(circle at center, rgba(0,0,0,0.2), rgba(0,0,0,0.8)); }

    .overlay { position: absolute; inset: 50% auto auto 50%; transform: translate(-50%, -50%); text-align: center; color: #fff; z-index: 1; padding: 0 10px; }
    .overlay h1 { font-size: 64px; text-shadow: 0 0 10px rgba(244,180,0,0.8); margin-bottom: 20px; }
    .overlay a.start-btn {
      display: inline-block; padding: 16px 32px; font-size: 20px;
      background: linear-gradient(45deg, #f4b400, #ffea00); color: #000; text-decoration: none;
      border-radius: 50px; box-shadow: 0 0 15px rgba(244,180,0,0.7); transition: box-shadow 0.3s, transform 0.2s;
    }
    .overlay a.start-btn:hover { box-shadow: 0 0 25px rgba(255,234,0,0.9); transform: translateY(-5px); }

    .panel {
      position: absolute; inset: 50% auto auto 50%; transform: translate(-50%, -50%);
      background: rgba(20,20,40,0.9); padding: 30px; border-radius: 10px; width: 90%; max-width: 500px; display: none; z-index: 2; box-shadow: 0 0 20px rgba(0,0,0,0.7);
    }
    .panel.active { display: block; }
    .panel h2 { font-size: 24px; margin-bottom: 10px; color: #f4b400; }
    .panel p { margin-bottom: 15px; line-height: 1.5; color: #ddd; font-size: 14px; }
    .panel ul { margin-left: 20px; margin-bottom: 15px; color: #ddd; }
    .panel ul li { margin-bottom: 8px; font-size: 14px; }
    .panel .close-btn { display: block; margin: 0 auto; padding: 10px 20px; background: #f44336; color: #fff; border: none; border-radius: 5px; cursor: pointer; transition: background 0.3s; }
    .panel .close-btn:hover { background: #e53935; }

    /* âœ… í™˜ê²½ ë°°ì§€ & ì—°ê²°ì •ë³´ íŒ¨ë„ (ê¸°ë³¸: PC ë ˆì´ì•„ì›ƒ) */
    #env-badge {
      position: fixed; top: 8px; right: 8px;
      padding: 6px 10px; border-radius: 999px;
      background: rgba(20,20,40,0.85); color: #fff;
      border: 1px solid rgba(244,180,0,0.4);
      font-size: 12px; letter-spacing: .4px;
      z-index: 10001; cursor: pointer; user-select: none;
      backdrop-filter: blur(4px);
    }
    #env-badge::after { content: 'â“˜'; margin-left: 6px; opacity: .7; font-weight: 700; }
    #env-panel {
      position: fixed; top: 40px; right: 8px;
      width: 340px; max-width: calc(100vw - 16px);
      max-height: 80vh; overflow: auto;
      background: rgba(10,10,25,0.98); color: #fff;
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: 0 8px 24px rgba(0,0,0,.55);
      border-radius: 12px; padding: 12px; display: none;
      z-index: 10002; backdrop-filter: blur(6px);
      -webkit-overflow-scrolling: touch;
    }
    #env-panel h3 { margin: 2px 0 8px; font-size: 14px; color: #f4b400; }
    #env-panel dl { display: grid; grid-template-columns: 120px 1fr; gap: 6px 10px; font-size: 12px; word-break: break-all; }
    #env-panel dt { color: #aab; }
    #env-panel dd { color: #eef; margin: 0; }
    #env-panel .muted { opacity: .8; font-size: 11px; }
    #env-panel .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    #env-close {
      background: transparent; border: 0; color: #fff; font-size: 18px;
      line-height: 1; cursor: pointer; padding: 4px 8px; border-radius: 6px;
    }
    #env-close:hover { background: rgba(255,255,255,.08); }

    /* Responsive (ëª¨ë°”ì¼ ë” ì‘ê²Œ) */
    @media (max-width: 768px) {
      .container { flex-direction: column; }

      .sidebar {
        width: 100%; flex-direction: row; justify-content: space-around;
        padding: 8px 6px; gap: 8px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      }
      .sidebar button { width: auto; padding: 6px 10px; font-size: 12px; border-radius: 18px; }

      .overlay h1 { font-size: 28px; }
      .overlay a.start-btn { padding: 9px 16px; font-size: 15px; border-radius: 18px; }

      /* âœ… ë°°ì§€ ë” ì‘ê²Œ + ìš°í•˜ë‹¨ */
      #env-badge {
        top: auto; right: 6px; bottom: calc(6px + env(safe-area-inset-bottom, 0px));
        padding: 4px 7px; font-size: 10px; border-radius: 12px;
      }

      /* âœ… íŒ¨ë„ ë” ì‘ê²Œ */
      #env-panel {
        top: auto; bottom: calc(42px + env(safe-area-inset-bottom, 0px)); right: 6px;
        width: 240px; max-width: calc(100vw - 12px);
        max-height: 55vh; padding: 8px; border-radius: 10px;
      }
      #env-panel h3 { font-size: 12px; }
      #env-panel dl { grid-template-columns: 90px 1fr; gap: 3px 6px; font-size: 10px; }
      #env-panel .muted { font-size: 9px; }

      /* âœ… ë¼ì´ì„¼ìŠ¤/ì»¨íƒ íŒ¨ë„ë„ ì†Œí˜•í™” */
      .panel { width: 92%; max-width: 420px; padding: 20px; }
      .panel h2 { font-size: 20px; }
      .panel p, .panel ul li { font-size: 12px; }
      .panel .close-btn { padding: 8px 16px; font-size: 12px; border-radius: 6px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <nav class="sidebar">
      <button id="show-license">ë¼ì´ì„¼ìŠ¤ ì •ë³´</button>
      <button id="show-contact">Contact Us</button>
    </nav>

    <div class="content">
      <div class="overlay">
        <h1>íƒœì–‘ê³„ì •ë³µ</h1>
        <!-- PC: íŒì—…(í˜„ì¬ íƒ­ ìœ ì§€) / ëª¨ë°”ì¼: ê°™ì€ íƒ­ -->
        <a href="game.html" id="start-btn" class="start-btn">ê²Œì„ ì‹œì‘</a>
      </div>

      <!-- íŒì—… ì°¨ë‹¨ ì•ˆë‚´ í† ìŠ¤íŠ¸ -->
      <div id="popup-hint" style="display:none; position:fixed; left:50%; bottom:24px; transform:translateX(-50%); background:rgba(20,20,40,0.95); color:#fff; padding:12px 16px; border-radius:10px; box-shadow:0 4px 16px rgba(0,0,0,0.4); font-size:14px; z-index:10000;">
        íŒì—…ì´ ì°¨ë‹¨ë˜ì–´ ìƒˆ ì°½ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì£¼ì†Œì°½ ìš°ì¸¡ íŒì—… ì°¨ë‹¨ ì•„ì´ì½˜ì—ì„œ í—ˆìš©í•´ ì£¼ì„¸ìš”.
      </div>

      <div class="panel" id="license-panel" aria-modal="true" role="dialog">
        <h2>ë¼ì´ì„¼ìŠ¤ ì •ë³´</h2>
        <p>Â© 2025 SIU Studio. All rights reserved.</p>
        <p>ë³¸ ê²Œì„ì˜ ì†ŒìŠ¤ ì½”ë“œ ë° ë¦¬ì†ŒìŠ¤(ì˜ˆ: ì´ë¯¸ì§€, ì‚¬ìš´ë“œ, ë””ìì¸, ìŠ¤í¬ë¦½íŠ¸ ë“±)ëŠ” ì œì‘ìì˜ ëª…ì‹œì  ì„œë©´ í—ˆê°€ ì—†ì´ ë‹¤ìŒ í–‰ìœ„ë¥¼ ëª¨ë‘ ê¸ˆì§€í•©ë‹ˆë‹¤:</p>
        <ul>
          <li>ë³µì‚¬(Copying)</li>
          <li>ìˆ˜ì •(Modification)</li>
          <li>ë¦¬ë²„ìŠ¤ ì—”ì§€ë‹ˆì–´ë§(Reverse Engineering)</li>
          <li>ì¬ë°°í¬(Redistribution)</li>
          <li>ìƒì—…ì  ì´ìš©(Commercial Use)</li>
        </ul>
        <p>ë‹¨, ê°œì¸ì´ ë¹„ìƒì—…ì  ëª©ì ìœ¼ë¡œ ê²Œì„ í”Œë ˆì´ ì˜ìƒì„ ë…¹í™”í•˜ì—¬ YouTube, Twitch ë“± ë™ì˜ìƒ í”Œë«í¼ì— ê²Œì‹œí•˜ëŠ” í–‰ìœ„ëŠ” í—ˆìš©ë©ë‹ˆë‹¤.</p>
        <p>ìœ„ ì¡°ê±´ì„ ìœ„ë°˜í•  ê²½ìš° ë¯¼Â·í˜•ì‚¬ìƒ ë²•ì  ì¡°ì¹˜ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
        <button class="close-btn" data-target="license-panel">ë‹«ê¸°</button>
      </div>

      <div class="panel" id="contact-panel" aria-modal="true" role="dialog">
        <h2>Contact Us</h2>
        <p>ë¬¸ì˜ ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì•„ë˜ ì´ë©”ì¼ë¡œ ì—°ë½ ì£¼ì„¸ìš”:</p>
        <p><a href="mailto:support@siustudio.kro.kr" style="color: #f4b400; text-decoration: none;">support@siustudio.kro.kr</a></p>
        <button class="close-btn" data-target="contact-panel">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <!-- í™˜ê²½ ë°°ì§€ & ì—°ê²°ì •ë³´ íŒ¨ë„ -->
  <div id="env-badge" title="í´ë¦­í•˜ë©´ ì—°ê²°ì •ë³´ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤."></div>
  <div id="env-panel" role="dialog" aria-modal="true" aria-labelledby="env-title">
    <div class="row">
      <h3 id="env-title">ì—°ê²° ì •ë³´</h3>
      <button id="env-close" aria-label="ë‹«ê¸°">âœ•</button>
    </div>
    <dl id="env-list"><!-- JSì—ì„œ ì±„ì›ë‹ˆë‹¤ --></dl>
    <p class="muted" style="margin-top:8px;">* ì¼ë¶€ ê°’ì€ ë¸Œë¼ìš°ì €/OS ì •ì±…ìœ¼ë¡œ ë¹„ê³µê°œì´ê±°ë‚˜ ê·¼ì‚¬ì¹˜ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </div>

  <!-- íŒ¨ë„ í† ê¸€ -->
  <script>
    const $licenseBtn = document.getElementById('show-license');
    const $contactBtn = document.getElementById('show-contact');
    const $licensePanel = document.getElementById('license-panel');
    const $contactPanel = document.getElementById('contact-panel');
    const $envPanel = document.getElementById('env-panel');

    function closeEnvPanel(){ $envPanel.style.display = 'none'; }

    document.querySelectorAll('.close-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.getElementById(btn.getAttribute('data-target')).classList.remove('active');
      });
    });

    // ì—´ê¸° ì‹œ ì„œë¡œ ê²¹ì¹˜ì§€ ì•Šë„ë¡
    $licenseBtn.addEventListener('click', () => {
      closeEnvPanel();
      $contactPanel.classList.remove('active');
      $licensePanel.classList.add('active');
    });
    $contactBtn.addEventListener('click', () => {
      closeEnvPanel();
      $licensePanel.classList.remove('active');
      $contactPanel.classList.add('active');
    });
  </script>

  <!-- í™˜ê²½ ë°°ì§€ & ì—°ê²°ì •ë³´ ë¡œì§ (+ ì„œë²„ ìƒ¤ë“œ í‘œì‹œ í›… í¬í•¨) -->
  <script>
    (function () {
      const $badge = document.getElementById('env-badge');
      const $panel = document.getElementById('env-panel');
      const $list  = document.getElementById('env-list');
      const $close = document.getElementById('env-close');

      function isMobileLike() {
        const ua = navigator.userAgent || '';
        const uaDataMobile = (navigator.userAgentData && typeof navigator.userAgentData.mobile === 'boolean')
          ? navigator.userAgentData.mobile : null;
        const touch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
        const smallScreen = Math.max(screen.width, screen.height) < 1024;
        const mobUA = /(Mobi|Android|iPhone|iPad|iPod|Windows Phone|BlackBerry)/i.test(ua);
        if (uaDataMobile !== null) return uaDataMobile;
        if (mobUA) return true;
        return touch && smallScreen;
      }
      function bool(v){ return v ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'; }
      function getConn() {
        const c = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
        if (!c) return null;
        return { type: c.type, effectiveType: c.effectiveType, downlinkMbps: c.downlink, rttMs: c.rtt, saveData: !!c.saveData };
      }
      function tz(){ try { return Intl.DateTimeFormat().resolvedOptions().timeZone; } catch(_) { return ''; } }
      function hoverPointer() {
        const canHover = window.matchMedia && window.matchMedia('(hover: hover)').matches;
        const coarse = window.matchMedia && window.matchMedia('(pointer: coarse)').matches;
        const fine   = window.matchMedia && window.matchMedia('(pointer: fine)').matches;
        return { canHover, coarse, fine };
      }
      function displayMode() {
        if (!window.matchMedia) return 'browser';
        if (window.matchMedia('(display-mode: standalone)').matches) return 'standalone';
        if (window.matchMedia('(display-mode: minimal-ui)').matches) return 'minimal-ui';
        if (window.matchMedia('(display-mode: fullscreen)').matches) return 'fullscreen';
        return 'browser';
      }
      function deviceTypeLabel(){ return isMobileLike() ? 'ëª¨ë°”ì¼' : 'PC'; }

      function gather() {
        const h = hoverPointer();
        const conn = getConn();
        const ua = navigator.userAgent || '';
        const uaDataPlat = (navigator.userAgentData && navigator.userAgentData.platform) ? navigator.userAgentData.platform : '';
        const langs = (navigator.languages && navigator.languages.length ? navigator.languages.join(', ') : navigator.language || '');
        const ref = document.referrer || '';

        const rows = [];

        // ğŸ”¸ ë¡œê·¸ì¸/ì„œë²„ ìƒ¤ë“œ ì •ë³´ (Firebase ëª¨ë“ˆì—ì„œ ì£¼ì…)
        const authLabel = (window.__AUTH_STATUS || 'ë¹„ë¡œê·¸ì¸');
        rows.push(['ê³„ì • ìƒíƒœ', authLabel]);
        if (window.__SERVER_INFO) {
          rows.push(['ë°ì´í„° ì„œë²„', window.__SERVER_INFO.server || '-']);
          if (window.__SERVER_INFO.id) rows.push(['ì €ì¥ ID', window.__SERVER_INFO.id]);
        }

        // ë‚˜ë¨¸ì§€ í™˜ê²½ ì •ë³´
        rows.push(['ë””ë°”ì´ìŠ¤', deviceTypeLabel()]);
        rows.push(['í”Œë«í¼', uaDataPlat || navigator.platform || '']);
        rows.push(['PWA í‘œì‹œëª¨ë“œ', displayMode()]);
        rows.push(['ì˜¨ë¼ì¸', bool(navigator.onLine)]);
        rows.push(['ì–¸ì–´', langs]);
        rows.push(['íƒ€ì„ì¡´', tz() || '']);
        rows.push(['ë·°í¬íŠ¸', `${window.innerWidth} Ã— ${window.innerHeight}`]);
        rows.push(['ìŠ¤í¬ë¦°', `${screen.width} Ã— ${screen.height}`]);
        rows.push(['DPR', String(window.devicePixelRatio || 1)]);
        rows.push(['í„°ì¹˜ ì§€ì›', bool(('ontouchstart' in window) || (navigator.maxTouchPoints > 0))]);
        rows.push(['ë§ˆìš°ìŠ¤ Hover', bool(h.canHover)]);
        rows.push(['í¬ì¸í„°(êµµìŒ)', bool(h.coarse)]);
        rows.push(['í¬ì¸í„°(ì •ë°€)', bool(h.fine)]);
        rows.push(['ì¿ í‚¤ ì‚¬ìš©', bool(navigator.cookieEnabled)]);
        rows.push(['Referrer', ref || '(ì—†ìŒ)']);
        rows.push(['User-Agent', ua]);

        if (conn) {
          rows.push(['ë„¤íŠ¸ì›Œí¬ ìœ í˜•', conn.type || '(ì•Œ ìˆ˜ ì—†ìŒ)']);
          rows.push(['íš¨ê³¼ì  ìœ í˜•', conn.effectiveType || '(ì•Œ ìˆ˜ ì—†ìŒ)']);
          rows.push(['ì¶”ì • ë‹¤ìš´ë§í¬(Mbps)', typeof conn.downlinkMbps === 'number' ? String(conn.downlinkMbps) : '(ì•Œ ìˆ˜ ì—†ìŒ)']);
          rows.push(['RTT(ms)', typeof conn.rttMs === 'number' ? String(conn.rttMs) : '(ì•Œ ìˆ˜ ì—†ìŒ)']);
          rows.push(['ë°ì´í„° ì ˆì•½ëª¨ë“œ', bool(conn.saveData)]);
        } else {
          rows.push(['ë„¤íŠ¸ì›Œí¬', '(API ë¯¸ì§€ì›)']);
        }
        return rows;
      }

      function render() {
        const rows = gather();
        document.getElementById('env-badge').textContent = deviceTypeLabel();
        $list.innerHTML = rows.map(([k,v]) => `<dt>${k}</dt><dd>${(v===undefined||v===null||v==='')?'-':String(v)}</dd>`).join('');
      }

      function openPanel(){
        // ë‹¤ë¥¸ íŒ¨ë„ ë‹«ê³  ì—´ê¸°
        document.getElementById('license-panel').classList.remove('active');
        document.getElementById('contact-panel').classList.remove('active');
        render();
        $panel.style.display = 'block';
      }
      function closePanel(){ $panel.style.display = 'none'; }

      document.getElementById('env-badge').addEventListener('click', () => ($panel.style.display === 'block' ? closePanel() : openPanel()));
      document.getElementById('env-close').addEventListener('click', closePanel);
      document.addEventListener('keydown', e => { if (e.key === 'Escape') closePanel(); });
      document.addEventListener('click', e => { if ($panel.style.display==='block' && !e.target.closest('#env-panel, #env-badge')) closePanel(); });

      ['resize', 'orientationchange', 'online', 'offline'].forEach(evt => window.addEventListener(evt, () => { if ($panel.style.display==='block') render(); }));
      if (navigator.connection && typeof navigator.connection.addEventListener === 'function') {
        navigator.connection.addEventListener('change', () => { if ($panel.style.display==='block') render(); });
      }

      // âœ… ì™¸ë¶€(Firebase ëª¨ë“ˆ)ì—ì„œ ì„œë²„ ì •ë³´ ì£¼ì…í•  ìˆ˜ ìˆë„ë¡ í›… ì œê³µ
      window.__updateServerInfo = function(info){
        window.__SERVER_INFO = info || null;
        if ($panel.style.display==='block') render();
      };
      window.__setAuthStatus = function(label){
        window.__AUTH_STATUS = label || null;
        if ($panel.style.display==='block') render();
      };

      // ì´ˆê¸° ë¼ë²¨
      document.getElementById('env-badge').textContent = deviceTypeLabel();
    })();
  </script>

  <!-- PC: íŒì—…(í˜„ì¬ íƒ­ ìœ ì§€) / ëª¨ë°”ì¼: ê°™ì€ íƒ­ -->
  <script>
    (function () {
      const POPUP_NAME = 'gameWindow';
      const GAME_URL   = 'game.html';
      const W = 1024, H = 768;

      // âœ… í† ìŠ¤íŠ¸ëŠ” "ì‚¬ìš©ì ì œìŠ¤ì²˜ ìˆœê°„ì˜ open ì‹¤íŒ¨"ì¼ ë•Œë§Œ ë…¸ì¶œ
      let lastAttemptFromUser = false;
      let suppressNextHint = false;

      function showPopupHint(msg){
        if (!lastAttemptFromUser || suppressNextHint) return;
        var el = document.getElementById('popup-hint');
        if(!el) return;
        el.textContent = msg || 'íŒì—…ì´ ì°¨ë‹¨ë˜ì–´ ìƒˆ ì°½ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì£¼ì†Œì°½ ìš°ì¸¡ íŒì—… ì°¨ë‹¨ ì•„ì´ì½˜ì—ì„œ í—ˆìš©í•´ ì£¼ì„¸ìš”.';
        el.style.display = 'block';
        clearTimeout(showPopupHint._t);
        showPopupHint._t = setTimeout(function(){ el.style.display='none'; }, 4000);
      }

      function isDesktop() {
        const ua = navigator.userAgent || '';
        if (navigator.userAgentData && typeof navigator.userAgentData.mobile === 'boolean') {
          return navigator.userAgentData.mobile === false;
        }
        if (/(Mobi|Android|iPhone|iPad|iPod|Windows Phone|BlackBerry)/i.test(ua)) return false;
        const finePointer = window.matchMedia?.('(pointer: fine)')?.matches;
        const canHover    = window.matchMedia?.('(hover: hover)')?.matches;
        if (finePointer && canHover) return true;
        return Math.max(screen.width, screen.height) >= 1024;
      }

      function openGamePopup(url) {
        const left = Math.max(0, Math.round((screen.width  - W) / 2));
        const top  = Math.max(0, Math.round((screen.height - H) / 2));
        const opts = [
          `width=${W}`, `height=${H}`, `left=${left}`, `top=${top}`,
          'resizable=yes','scrollbars=yes','status=no','toolbar=no','menubar=no','noopener','noreferrer'
        ].join(',');
        let win = null;
        try { win = window.open(url, POPUP_NAME, opts); } catch(e) { win = null; }
        return win;
      }

      function shouldUsePopup(){ return isDesktop(); }

      const startBtn = document.getElementById('start-btn');
      if (!startBtn) return;

      startBtn.addEventListener('click', function (e) {
        if (!shouldUsePopup()) return; // ëª¨ë°”ì¼: ê¸°ë³¸ ì´ë™
        e.preventDefault(); // PC: í˜„ì¬ íƒ­ ìœ ì§€
        lastAttemptFromUser = true;
        suppressNextHint = false;

        const p = openGamePopup(GAME_URL);
        if (!p || p.closed) {
          showPopupHint('íŒì—…ì´ ì°¨ë‹¨ë˜ì–´ ìƒˆ ì°½ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ í—ˆìš©í•´ì£¼ì„¸ìš”.');
        } else {
          try { p.focus(); } catch {}
        }

        // ì œìŠ¤ì²˜ ì¢…ë£Œ: ë™ì¼ tick ì´í›„ë¡œ í”Œë˜ê·¸ í•´ì œ
        setTimeout(()=>{ lastAttemptFromUser = false; }, 0);
      });

      // âœ… íŒì—…ì´ ì •ìƒ ì¢…ë£Œ/ìš”ì²­ ì¢…ë£Œë  ë•ŒëŠ” "ì°¨ë‹¨" í† ìŠ¤íŠ¸ë¥¼ ì–µì œ
      window.addEventListener('message', (e)=>{
        const t = e.data && e.data.type;
        if (t === 'request-close-popup' || t === 'auto-close') {
          suppressNextHint = true;
          setTimeout(()=>{ suppressNextHint = false; }, 1000);
        }
      }, false);
    })();
  </script>

  <!-- âœ… Firebase ë¡œë“œ: ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ "ë°ì´í„° ì„œë²„(serverN)" ì •ë³´ í‘œì‹œ -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";
    import { getDatabase, ref, get, runTransaction, update } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAIrsnUYEBG3cqbPrKD_eejOdtsCDjYG9k",
      authDomain: "siu-studio.firebaseapp.com",
      databaseURL: "https://siu-studio-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "siu-studio",
      storageBucket: "siu-studio.appspot.com",
      messagingSenderId: "830887143444",
      appId: "1:830887143444:web:70b45fc12140e893c31f01",
      measurementId: "G-1Y090YJDB6"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);

    // â”€â”€ ìƒ¤ë”© ìœ í‹¸ (ë‹¤ë¥¸ í˜ì´ì§€ë“¤ê³¼ ë™ì¼ ì •ì±…: 15ëª…/ì„œë²„, idKey ì¶©ëŒì‹œ uid ì¼ë¶€ ë¶™ì„)
    function sanitizeIdKey(raw) {
      const s = (raw || '').toString().trim().toLowerCase();
      const base = s.replace(/[^a-z0-9._-]+/g, '_').replace(/^_+|_+$/g, '');
      return base || 'user';
    }
    function makeIdKeyFromUser(user) {
      const email = (user.email || '').toString();
      if (email.includes('@')) {
        const local = email.split('@')[0];
        return sanitizeIdKey(local);
      }
      const dn = sanitizeIdKey(user.displayName || '');
      if (dn && dn !== 'user') return dn;
      return `user_${(user.uid || '').slice(0,6) || '000000'}`;
    }
    async function ensureServerMapping(user) {
      // 1) ê¸°ì¡´ ë§¤í•‘ ìˆìœ¼ë©´ ì‚¬ìš©
      try {
        const m = await get(ref(db, `userServerMap/${user.uid}`));
        if (m.exists()) {
          const { server, id } = m.val() || {};
          if (server && id) return { server, id };
        }
      } catch {}

      // 2) ì—†ìœ¼ë©´ ìƒˆë¡œ í• ë‹¹
      let nextIndex = 0;
      try {
        const res = await runTransaction(ref(db, 'meta/nextIndex'), cur => (cur || 0) + 1);
        nextIndex = res?.snapshot?.val() || 1;
      } catch {
        nextIndex = 1;
      }
      const serverNum = Math.max(1, Math.ceil(nextIndex / 15));
      const server = `server${serverNum}`;
      let idKey = makeIdKeyFromUser(user);

      // ê°™ì€ server ì•ˆì—ì„œ idKey ì¶©ëŒ ë°©ì§€
      try {
        const exists = await get(ref(db, `users/${server}/${idKey}`));
        if (exists.exists()) idKey = `${idKey}-${(user.uid||'').slice(0,4)}`;
      } catch {}

      try {
        await update(ref(db), { [`userServerMap/${user.uid}`]: { server, id: idKey, createdAt: Date.now() } });
      } catch {}

      return { server, id: idKey };
    }

    // ğŸ” ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼ íŒ¨ë„ ì •ë³´ ì—…ë°ì´íŠ¸
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        window.__setAuthStatus?.('ë¹„ë¡œê·¸ì¸');
        window.__updateServerInfo?.({ server: '-', id: '(ë¡œê·¸ì¸ í•„ìš”)' });
        return;
      }
      window.__setAuthStatus?.('ë¡œê·¸ì¸');

      try {
        const info = await ensureServerMapping(user);
        // íŒ¨ë„ì— ì„œë²„ ë²ˆí˜¸/ID í‘œì‹œ
        window.__updateServerInfo?.(info); // { server: 'serverN', id: 'idKey' }
      } catch (e) {
        console.warn('ì„œë²„ ë§¤í•‘ ì¡°íšŒ ì‹¤íŒ¨:', e);
        window.__updateServerInfo?.({ server: '(ì¡°íšŒ ì‹¤íŒ¨)', id: '-' });
      }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/disable-devtool@latest"></script>
  <script>
    DisableDevtool({
      disableMenu: true,
      disableSelect: true,
      disableCopy: true,
      disableCut: true,
      disablePaste: true,
      clearIntervalWhenDevOpenTrigger: true,
      ondevtoolopen(type, next) { window.close(); next(); },
      ondevtoolclose() { console.warn('DevTools ë‹«í˜ ê°ì§€ë¨'); }
    });
  </script>

  <script>
    // ìš°í´ë¦­ ì°¨ë‹¨ (ì…ë ¥ ì˜ì—­ì€ í—ˆìš©)
    document.addEventListener('contextmenu', function (e) {
      if (e.target.closest('input, textarea, [contenteditable="true"]')) return;
      e.preventDefault();
    });
  </script>

  <!-- íŒì—…ìœ¼ë¡œ ì—´ë ¸ì„ ë•Œ ìë™ ì¢…ë£Œ (ì›ë³¸ ìœ ì§€ + ì˜¤íƒ€ ìˆ˜ì •) -->
  <script>
    (function() {
      try {
        const openedByScript = !!window.opener;
        if (openedByScript) {
          const CLOSE_DELAY_MS = 500;
          setTimeout(() => {
            try { window.opener.postMessage && window.opener.postMessage({ type: 'auto-close', from: location.href }, '*'); } catch (e) {}
            try { window.close(); } catch (e) {}
            setTimeout(() => {
              try { window.location.href = 'about:blank'; } catch (e) {}
              try { window.close(); } catch (e) {}
            }, 50);
          }, CLOSE_DELAY_MS);
        }
      } catch (e) {
        console.warn('íŒì—… ìë™ ì¢…ë£Œ ê²€ì‚¬ ì¤‘ ì˜¤ë¥˜:', e);
      }
    })();
  </script>
</body>
</html>
ã„´
