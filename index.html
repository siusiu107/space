<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>ÌÉúÏñëÍ≥ÑÏ†ïÎ≥µ - Î©îÏù∏ Î©îÎâ¥</title>
  <meta name="description" content="ÌÉúÏñëÍ≥ÑÏ†ïÎ≥µ - Ïö∞Ï£º ÏÉùÏ°¥ ÌÅ¥Î¶≠Ïª§. ÏßÅÍ¥ÄÏ†ÅÏù∏ Ï°∞ÏûëÍ≥º ÌôîÎ†§Ìïú Í∑∏ÎûòÌîΩÏùò HTML Í≤åÏûÑÏûÖÎãàÎã§. ÏßÄÍ∏à ÌåùÏóÖÏúºÎ°ú Í≤åÏûÑÏùÑ Ïã§ÌñâÌïòÏÑ∏Ïöî.">
  <meta name="keywords" content="ÌÉúÏñëÍ≥Ñ, Ïö∞Ï£º, ÌÅ¥Î¶≠Ïª§, HTML Í≤åÏûÑ, SIU Studio">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="./">

  <!-- Open Graph -->
  <meta property="og:title" content="ÌÉúÏñëÍ≥ÑÏ†ïÎ≥µ - SIU Studio">
  <meta property="og:description" content="ÏßÅÍ¥ÄÏ†ÅÏù∏ Ï°∞ÏûëÍ≥º ÌôîÎ†§Ìïú Í∑∏ÎûòÌîΩÏùò Ïö∞Ï£º ÏÉùÏ°¥ ÌÅ¥Î¶≠Ïª§. ÏßÄÍ∏à ÌåùÏóÖÏúºÎ°ú Í≤åÏûÑÏùÑ Ïã§ÌñâÌïòÏÑ∏Ïöî.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="space-bg.jpg">
  <meta property="og:image:alt" content="ÌÉúÏñëÍ≥ÑÏ†ïÎ≥µ Ïç∏ÎÑ§Ïùº">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ÌÉúÏñëÍ≥ÑÏ†ïÎ≥µ - SIU Studio">
  <meta name="twitter:description" content="ÏßÅÍ¥ÄÏ†ÅÏù∏ Ï°∞ÏûëÍ≥º ÌôîÎ†§Ìïú Í∑∏ÎûòÌîΩÏùò Ïö∞Ï£º ÏÉùÏ°¥ ÌÅ¥Î¶≠Ïª§. ÏßÄÍ∏à ÌåùÏóÖÏúºÎ°ú Í≤åÏûÑÏùÑ Ïã§ÌñâÌïòÏÑ∏Ïöî.">
  <meta name="twitter:image" content="space-bg.jpg">

  <!-- Icons -->
  <link rel="icon" href="space-bg.jpg" type="image/jpeg">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="icon" href="/favicon.ico?v=2" type="image/x-icon">

  <!-- PWA -->
  <link rel="manifest" href="/site.webmanifest">
  <meta name="msapplication-TileColor" content="#2d89ef">
  <meta name="theme-color" content="#ffffff">

  <script>
    try { history.replaceState(null, '', '/main' + (location.hash || '')); }
    catch(e){ console.warn('Ï£ºÏÜå ÌëúÏãú Î≥ÄÍ≤Ω Ïã§Ìå®:', e); }
  </script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html { height: 100%; font-family: 'Orbitron', sans-serif; background: #000; }
    .container { display: flex; flex-direction: row; height: 100vh; }
    .sidebar {
      width: 250px;
      background: rgba(10, 10, 30, 0.8);
      display: flex; flex-direction: column; align-items: center;
      padding-top: 40px; gap: 20px;
      box-shadow: 5px 0 15px rgba(0,0,0,0.5);
      z-index: 3;
    }
    .sidebar button {
      width: 80%; padding: 12px 0; text-align: center; text-decoration: none;
      color: #fff; background: rgba(255,255,255,0.1); border: none; border-radius: 30px;
      cursor: pointer; transition: background 0.3s, transform 0.2s;
    }
    .sidebar button:hover { background: rgba(244,180,0,0.8); transform: scale(1.05); color: #000; }

    .content { flex: 1; position: relative; background: url('background.jpg') center/cover no-repeat; }
    .content::after { content: ''; position: absolute; inset: 0; background: radial-gradient(circle at center, rgba(0,0,0,0.2), rgba(0,0,0,0.8)); }

    .overlay { position: absolute; inset: 50% auto auto 50%; transform: translate(-50%, -50%); text-align: center; color: #fff; z-index: 1; padding: 0 10px; }
    .overlay h1 { font-size: 64px; text-shadow: 0 0 10px rgba(244,180,0,0.8); margin-bottom: 20px; }
    .overlay a.start-btn {
      display: inline-block; padding: 16px 32px; font-size: 20px;
      background: linear-gradient(45deg, #f4b400, #ffea00); color: #000; text-decoration: none;
      border-radius: 50px; box-shadow: 0 0 15px rgba(244,180,0,0.7); transition: box-shadow 0.3s, transform 0.2s;
    }
    .overlay a.start-btn:hover { box-shadow: 0 0 25px rgba(255,234,0,0.9); transform: translateY(-5px); }

    .panel {
      position: absolute; inset: 50% auto auto 50%; transform: translate(-50%, -50%);
      background: rgba(20,20,40,0.9); padding: 30px; border-radius: 10px; width: 90%; max-width: 520px; display: none; z-index: 2; box-shadow: 0 0 20px rgba(0,0,0,0.7);
    }
    .panel.active { display: block; }
    .panel h2 { font-size: 24px; margin-bottom: 10px; color: #f4b400; }
    .panel p { margin-bottom: 15px; line-height: 1.5; color: #ddd; font-size: 14px; }
    .panel ul { margin-left: 20px; margin-bottom: 15px; color: #ddd; }
    .panel ul li { margin-bottom: 8px; font-size: 14px; }
    .panel .close-btn { display: block; margin: 0 auto; padding: 10px 20px; background: #f44336; color: #fff; border: none; border-radius: 5px; cursor: pointer; transition: background 0.3s; }
    .panel .close-btn:hover { background: #e53935; }

    /* ‚úÖ ÌôòÍ≤Ω Î∞∞ÏßÄ & Ïó∞Í≤∞Ï†ïÎ≥¥ Ìå®ÎÑê */
    #env-badge {
      position: fixed; top: 8px; right: 8px;
      padding: 6px 10px; border-radius: 999px;
      background: rgba(20,20,40,0.85); color: #fff;
      border: 1px solid rgba(244,180,0,0.4);
      font-size: 12px; letter-spacing: .4px;
      z-index: 10001; cursor: pointer; user-select: none;
      backdrop-filter: blur(4px);
    }
    #env-badge::after { content: ' ‚ìò'; opacity: .7; font-weight: 700; }
    #env-panel {
      position: fixed; top: 40px; right: 8px;
      width: 340px; max-width: calc(100vw - 16px);
      max-height: 80vh; overflow: auto;
      background: rgba(10,10,25,0.98); color: #fff;
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: 0 8px 24px rgba(0,0,0,.55);
      border-radius: 12px; padding: 12px; display: none;
      z-index: 10002; backdrop-filter: blur(6px);
      -webkit-overflow-scrolling: touch;
    }
    #env-panel h3 { margin: 2px 0 8px; font-size: 14px; color: #f4b400; }
    #env-panel dl { display: grid; grid-template-columns: 120px 1fr; gap: 6px 10px; font-size: 12px; word-break: break-all; }
    #env-panel dt { color: #aab; }
    #env-panel dd { color: #eef; margin: 0; }
    #env-panel .muted { opacity: .8; font-size: 11px; }
    #env-panel .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    #env-close {
      background: transparent; border: 0; color: #fff; font-size: 18px;
      line-height: 1; cursor: pointer; padding: 4px 8px; border-radius: 6px;
    }
    #env-close:hover { background: rgba(255,255,255,.08); }

    /* ‚úÖ OTP Ìå®ÎÑê */
    #otp-panel .row { display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin:8px 0; }
    #otp-panel input { padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.18); background:rgba(0,0,0,.25); color:#e6f7ff; }
    #otp-panel .hint { font-size:12px; color:#bbb }
    .btn { padding:10px 14px; border-radius:10px; border:1px solid rgba(255,255,255,.18); background:rgba(255,255,255,.1); color:#fff; cursor:pointer }
    .btn.primary { background:linear-gradient(180deg,#38bdf8,#0ea5e9); border-color:#0891b2; font-weight:800 }
    .btn.ok { background:linear-gradient(180deg,#34d399,#16a34a); border-color:#16a34a; font-weight:800 }
    .btn:disabled{opacity:.6;cursor:not-allowed}

    /* Responsive */
    @media (max-width: 768px) {
      .container { flex-direction: column; }
      .sidebar {
        width: 100%; flex-direction: row; justify-content: space-around;
        padding: 8px 6px; gap: 8px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
      }
      .sidebar button { width: auto; padding: 6px 10px; font-size: 12px; border-radius: 18px; }
      .overlay h1 { font-size: 28px; }
      .overlay a.start-btn { padding: 9px 16px; font-size: 15px; border-radius: 18px; }
      #env-badge {
        top: auto; right: 6px; bottom: calc(6px + env(safe-area-inset-bottom, 0px));
        padding: 4px 7px; font-size: 10px; border-radius: 12px;
      }
      #env-panel {
        top: auto; bottom: calc(42px + env(safe-area-inset-bottom, 0px)); right: 6px;
        width: 240px; max-width: calc(100vw - 12px);
        max-height: 55vh; padding: 8px; border-radius: 10px;
      }
      #env-panel h3 { font-size: 12px; }
      #env-panel dl { grid-template-columns: 90px 1fr; gap: 3px 6px; font-size: 10px; }
      #env-panel .muted { font-size: 9px; }
      .panel { width: 92%; max-width: 420px; padding: 20px; }
      .panel h2 { font-size: 20px; }
      .panel p, .panel ul li { font-size: 12px; }
      .panel .close-btn { padding: 8px 16px; font-size: 12px; border-radius: 6px; }
    }

    /* ÌÜ†Ïä§Ìä∏ */
    #toast{
      position:fixed; left:50%; bottom:24px; transform:translateX(-50%) translateY(16px);
      background:rgba(20,20,40,0.95); color:#fff; padding:12px 16px; border-radius:10px; box-shadow:0 4px 16px rgba(0,0,0,.4); font-size:14px; z-index:10000;
      border:1px solid rgba(255,255,255,.12); opacity:0; transition:all .25s ease;
    }
    #toast.show{ opacity:1; transform:translateX(-50%) translateY(0) }

    /* ÎØ∏Ïù∏Ï¶ù Ïû†Í∏à ÌîÑÎ¶¨Î∑∞ */
    .lock{filter:blur(6px); user-select:none; pointer-events:none}
  </style>
</head>
<body>
  <div class="container">
    <nav class="sidebar">
      <button id="show-license">ÎùºÏù¥ÏÑºÏä§ Ï†ïÎ≥¥</button>
      <button id="show-contact">Contact Us</button>
      <!-- üîê OTP Ìå®ÎÑê Ïó¥Í∏∞ -->
      <button id="show-otp">Ïù∏Ï¶ù(OTP)</button>
    </nav>

    <div class="content">
      <div class="overlay">
        <h1>ÌÉúÏñëÍ≥ÑÏ†ïÎ≥µ</h1>
        <!-- PC: ÌåùÏóÖ(ÌòÑÏû¨ ÌÉ≠ Ïú†ÏßÄ) / Î™®Î∞îÏùº: Í∞ôÏùÄ ÌÉ≠ -->
        <a href="game.html" id="start-btn" class="start-btn">Í≤åÏûÑ ÏãúÏûë</a>
        <div style="margin-top:10px;font-size:13px;opacity:.9">ÌôòÍ≤Ω: <span id="device-badge">ÌôïÏù∏ Ï§ë‚Ä¶</span></div>
      </div>

      <!-- ÌåùÏóÖ Ï∞®Îã® ÏïàÎÇ¥ ÌÜ†Ïä§Ìä∏ -->
      <div id="popup-hint" style="display:none; position:fixed; left:50%; bottom:24px; transform:translateX(-50%); background:rgba(20,20,40,0.95); color:#fff; padding:12px 16px; border-radius:10px; box-shadow:0 4px 16px rgba(0,0,0,0.4); font-size:14px; z-index:10000;">
        ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏñ¥ ÏÉà Ï∞ΩÏùÑ Ïó¥ Ïàò ÏóÜÏäµÎãàÎã§. Ï£ºÏÜåÏ∞Ω Ïö∞Ï∏° ÌåùÏóÖ Ï∞®Îã® ÏïÑÏù¥ÏΩòÏóêÏÑú ÌóàÏö©Ìï¥ Ï£ºÏÑ∏Ïöî.
      </div>

      <!-- ÎùºÏù¥ÏÑ†Ïä§ -->
      <div class="panel" id="license-panel" aria-modal="true" role="dialog">
        <h2>ÎùºÏù¥ÏÑºÏä§ Ï†ïÎ≥¥</h2>
        <p>¬© 2025 SIU Studio. All rights reserved.</p>
        <p>Î≥∏ Í≤åÏûÑÏùò ÏÜåÏä§ ÏΩîÎìú Î∞è Î¶¨ÏÜåÏä§(Ïòà: Ïù¥ÎØ∏ÏßÄ, ÏÇ¨Ïö¥Îìú, ÎîîÏûêÏù∏, Ïä§ÌÅ¨Î¶ΩÌä∏ Îì±)Îäî Ï†úÏûëÏûêÏùò Î™ÖÏãúÏ†Å ÏÑúÎ©¥ ÌóàÍ∞Ä ÏóÜÏù¥ Îã§Ïùå ÌñâÏúÑÎ•º Î™®Îëê Í∏àÏßÄÌï©ÎãàÎã§:</p>
        <ul>
          <li>Î≥µÏÇ¨(Copying)</li>
          <li>ÏàòÏ†ï(Modification)</li>
          <li>Î¶¨Î≤ÑÏä§ ÏóîÏßÄÎãàÏñ¥ÎßÅ(Reverse Engineering)</li>
          <li>Ïû¨Î∞∞Ìè¨(Redistribution)</li>
          <li>ÏÉÅÏóÖÏ†Å Ïù¥Ïö©(Commercial Use)</li>
        </ul>
        <p>Îã®, Í∞úÏù∏Ïù¥ ÎπÑÏÉÅÏóÖÏ†Å Î™©Ï†ÅÏúºÎ°ú Í≤åÏûÑ ÌîåÎ†àÏù¥ ÏòÅÏÉÅÏùÑ ÎÖπÌôîÌïòÏó¨ YouTube, Twitch Îì± ÎèôÏòÅÏÉÅ ÌîåÎû´ÌèºÏóê Í≤åÏãúÌïòÎäî ÌñâÏúÑÎäî ÌóàÏö©Îê©ÎãàÎã§.</p>
        <p>ÏúÑ Ï°∞Í±¥ÏùÑ ÏúÑÎ∞òÌï† Í≤ΩÏö∞ ÎØº¬∑ÌòïÏÇ¨ÏÉÅ Î≤ïÏ†Å Ï°∞ÏπòÎ•º Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</p>
        <button class="close-btn" data-target="license-panel">Îã´Í∏∞</button>
      </div>

      <!-- Ïª®ÌÉù -->
      <div class="panel" id="contact-panel" aria-modal="true" role="dialog">
        <h2>Contact Us</h2>
        <p>Î¨∏Ïùò ÏÇ¨Ìï≠Ïù¥ ÏûàÏúºÏãúÎ©¥ ÏïÑÎûò Ïù¥Î©îÏùºÎ°ú Ïó∞ÎùΩ Ï£ºÏÑ∏Ïöî:</p>
        <p><a href="mailto:support@siustudio.kro.kr" style="color: #f4b400; text-decoration: none;">support@siustudio.kro.kr</a></p>
        <button class="close-btn" data-target="contact-panel">Îã´Í∏∞</button>
      </div>

      <!-- üîê OTP Ìå®ÎÑê: Î°úÍ∑∏Ïù∏ + ÏΩîÎìú Î∞úÏÜ°/Í≤ÄÏ¶ù -->
      <div class="panel" id="otp-panel" aria-modal="true" role="dialog">
        <h2>Ïù∏Ï¶ù(OTP)</h2>
        <p style="margin-top:-6px">Ïù¥ ÌéòÏù¥ÏßÄÏóêÏÑú Ïó∞Í≤∞ Ï†ïÎ≥¥Î•º Î≥¥Î†§Î©¥ Firebase Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Î©îÏùºÎ°ú Î∞õÏùÄ <b>6ÏûêÎ¶¨ Ïù∏Ï¶ùÎ≤àÌò∏</b>Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî.</p>

        <!-- Î°úÍ∑∏Ïù∏ -->
        <div class="row">
          <button id="btn-google" class="btn primary">GoogleÎ°ú Î°úÍ∑∏Ïù∏</button>
          <button id="btn-logout" class="btn">Î°úÍ∑∏ÏïÑÏõÉ</button>
          <span id="auth-state" class="hint">ÎπÑÎ°úÍ∑∏Ïù∏</span>
        </div>
        <div class="row">
          <input id="email" type="email" placeholder="Ïù¥Î©îÏùº" autocomplete="username" />
          <input id="pw" type="password" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏" autocomplete="current-password" />
          <button id="btn-email-login" class="btn">Ïù¥Î©îÏùº Î°úÍ∑∏Ïù∏</button>
        </div>

        <!-- OTP -->
        <div class="row" style="margin-top:6px">
          <button id="btn-send" class="btn primary">Ïù∏Ï¶ùÎ≤àÌò∏ Î©îÏùº Î≥¥ÎÇ¥Í∏∞</button>
          <span class="hint">5Î∂Ñ Ïú†Ìö® ¬∑ 30Ï¥à Ïø®Îã§Ïö¥ ¬∑ 5Ìöå Ïò§Î•ò Ïãú Ï¥àÍ∏∞Ìôî</span>
        </div>
        <div class="row">
          <input id="otp-code" inputmode="numeric" pattern="[0-9]*" placeholder="6ÏûêÎ¶¨ ÏΩîÎìú" maxlength="6" />
          <button id="btn-verify" class="btn ok">Ïù∏Ï¶ùÎ≤àÌò∏ ÌôïÏù∏</button>
          <span id="unlock-left" class="hint" style="display:none"></span>
        </div>

        <button class="close-btn" data-target="otp-panel" style="margin-top:12px">Îã´Í∏∞</button>
      </div>
    </div>
  </div>

  <!-- ÌôòÍ≤Ω Î∞∞ÏßÄ & Ïó∞Í≤∞Ï†ïÎ≥¥ Ìå®ÎÑê -->
  <button id="env-badge" class="badge" title="ÌÅ¥Î¶≠ÌïòÎ©¥ Ïó∞Í≤∞Ï†ïÎ≥¥Î•º Î≥¥Ïó¨Ï§çÎãàÎã§.">-</button>
  <div id="env-panel" role="dialog" aria-modal="true" aria-labelledby="env-title">
    <div class="row">
      <h3 id="env-title">Ïó∞Í≤∞ Ï†ïÎ≥¥</h3>
      <button id="env-close" aria-label="Îã´Í∏∞">‚úï</button>
    </div>
    <dl id="env-list"><!-- JSÏóêÏÑú Ï±ÑÏõÄ --></dl>
    <p class="muted" style="margin-top:8px;">* ÏùºÎ∂Ä Í∞íÏùÄ Î∏åÎùºÏö∞Ï†Ä/OS Ï†ïÏ±ÖÏúºÎ°ú ÎπÑÍ≥µÍ∞úÏù¥Í±∞ÎÇò Í∑ºÏÇ¨ÏπòÏùº Ïàò ÏûàÏäµÎãàÎã§.</p>
  </div>

  <div id="toast" role="status" aria-live="polite">ÏïåÎ¶º</div>

  <!-- Ìå®ÎÑê ÌÜ†Í∏Ä (ÎùºÏù¥ÏÑ†Ïä§/Ïª®ÌÉù/OTP) -->
  <script>
    const $licenseBtn = document.getElementById('show-license');
    const $contactBtn = document.getElementById('show-contact');
    const $otpBtn     = document.getElementById('show-otp');
    const $licensePanel = document.getElementById('license-panel');
    const $contactPanel = document.getElementById('contact-panel');
    const $otpPanel     = document.getElementById('otp-panel');
    const $envPanel     = document.getElementById('env-panel');

    function closeEnvPanel(){ $envPanel.style.display = 'none'; }
    function closeAllPanels(){ ['license-panel','contact-panel','otp-panel'].forEach(id=>document.getElementById(id).classList.remove('active')); }

    document.querySelectorAll('.close-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.getElementById(btn.getAttribute('data-target')).classList.remove('active');
      });
    });

    $licenseBtn.addEventListener('click', () => { closeEnvPanel(); closeAllPanels(); $licensePanel.classList.add('active'); });
    $contactBtn.addEventListener('click', () => { closeEnvPanel(); closeAllPanels(); $contactPanel.classList.add('active'); });
    $otpBtn.addEventListener('click',     () => { closeEnvPanel(); closeAllPanels(); $otpPanel.classList.add('active'); });
  </script>

  <!-- ÌôòÍ≤Ω Î∞∞ÏßÄ & Ïó∞Í≤∞Ï†ïÎ≥¥ Î°úÏßÅ -->
  <script>
    (function () {
      const $badge = document.getElementById('env-badge');
      const $panel = document.getElementById('env-panel');
      const $list  = document.getElementById('env-list');
      const $close = document.getElementById('env-close');

      function isMobileLike() {
        const ua = navigator.userAgent || '';
        const uaDataMobile = (navigator.userAgentData && typeof navigator.userAgentData.mobile === 'boolean')
          ? navigator.userAgentData.mobile : null;
        const touch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0);
        const smallScreen = Math.max(screen.width, screen.height) < 1024;
        const mobUA = /(Mobi|Android|iPhone|iPad|iPod|Windows Phone|BlackBerry)/i.test(ua);
        if (uaDataMobile !== null) return uaDataMobile;
        if (mobUA) return true;
        return touch && smallScreen;
      }
      function bool(v){ return v ? 'Ïòà' : 'ÏïÑÎãàÏò§'; }
      function getConn() {
        const c = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
        if (!c) return null;
        return { type: c.type, effectiveType: c.effectiveType, downlinkMbps: c.downlink, rttMs: c.rtt, saveData: !!c.saveData };
      }
      function tz(){ try { return Intl.DateTimeFormat().resolvedOptions().timeZone; } catch(_) { return ''; } }
      function hoverPointer() {
        const canHover = window.matchMedia && window.matchMedia('(hover: hover)').matches;
        const coarse = window.matchMedia && window.matchMedia('(pointer: coarse)').matches;
        const fine   = window.matchMedia && window.matchMedia('(pointer: fine)').matches;
        return { canHover, coarse, fine };
      }
      function displayMode() {
        if (!window.matchMedia) return 'browser';
        if (window.matchMedia('(display-mode: standalone)').matches) return 'standalone';
        if (window.matchMedia('(display-mode: minimal-ui)').matches) return 'minimal-ui';
        if (window.matchMedia('(display-mode: fullscreen)').matches) return 'fullscreen';
        return 'browser';
      }
      function deviceTypeLabel(){ return isMobileLike() ? 'Î™®Î∞îÏùº' : 'PC'; }

      function gather() {
        const h = hoverPointer();
        const conn = getConn();
        const ua = navigator.userAgent || '';
        const uaDataPlat = (navigator.userAgentData && navigator.userAgentData.platform) ? navigator.userAgentData.platform : '';
        const langs = (navigator.languages && navigator.languages.length ? navigator.languages.join(', ') : navigator.language || '');
        const ref = document.referrer || '';

        const rows = [];
        rows.push(['ÎîîÎ∞îÏù¥Ïä§', deviceTypeLabel()]);
        rows.push(['ÌîåÎû´Ìèº', uaDataPlat || navigator.platform || '']);
        rows.push(['PWA ÌëúÏãúÎ™®Îìú', displayMode()]);
        rows.push(['Ïò®ÎùºÏù∏', bool(navigator.onLine)]);
        rows.push(['Ïñ∏Ïñ¥', langs]);
        rows.push(['ÌÉÄÏûÑÏ°¥', tz() || '']);
        rows.push(['Î∑∞Ìè¨Ìä∏', `${window.innerWidth} √ó ${window.innerHeight}`]);
        rows.push(['Ïä§ÌÅ¨Î¶∞', `${screen.width} √ó ${screen.height}`]);
        rows.push(['DPR', String(window.devicePixelRatio || 1)]);
        rows.push(['ÌÑ∞Ïπò ÏßÄÏõê', bool(('ontouchstart' in window) || (navigator.maxTouchPoints > 0))]);
        rows.push(['ÎßàÏö∞Ïä§ Hover', bool(h.canHover)]);
        rows.push(['Ìè¨Ïù∏ÌÑ∞(ÍµµÏùå)', bool(h.coarse)]);
        rows.push(['Ìè¨Ïù∏ÌÑ∞(Ï†ïÎ∞Ä)', bool(h.fine)]);
        rows.push(['Ïø†ÌÇ§ ÏÇ¨Ïö©', bool(navigator.cookieEnabled)]);
        rows.push(['Referrer', ref || '(ÏóÜÏùå)']);
        rows.push(['User-Agent', ua]);

        if (conn) {
          rows.push(['ÎÑ§Ìä∏ÏõåÌÅ¨ Ïú†Ìòï', conn.type || '(Ïïå Ïàò ÏóÜÏùå)']);
          rows.push(['Ìö®Í≥ºÏ†Å Ïú†Ìòï', conn.effectiveType || '(Ïïå Ïàò ÏóÜÏùå)']);
          rows.push(['Ï∂îÏ†ï Îã§Ïö¥ÎßÅÌÅ¨(Mbps)', typeof conn.downlinkMbps === 'number' ? String(conn.downlinkMbps) : '(Ïïå Ïàò ÏóÜÏùå)']);
          rows.push(['RTT(ms)', typeof conn.rttMs === 'number' ? String(conn.rttMs) : '(Ïïå Ïàò ÏóÜÏùå)']);
          rows.push(['Îç∞Ïù¥ÌÑ∞ Ï†àÏïΩÎ™®Îìú', bool(conn.saveData)]);
        } else {
          rows.push(['ÎÑ§Ìä∏ÏõåÌÅ¨', '(API ÎØ∏ÏßÄÏõê)']);
        }
        return rows;
      }

      function render() {
        const rows = gather();
        document.getElementById('env-badge').textContent = deviceTypeLabel() + (window.__ENV_LOCKED__ ? ' ¬∑ Ïû†ÍπÄ' : ' ¬∑ Ïó¥Îûå Ï§ë');
        document.getElementById('device-badge').textContent = deviceTypeLabel();
        $list.innerHTML = rows.map(([k,v]) => `<dt>${k}</dt><dd>${(v===undefined||v===null||v==='')?'-':String(v)}</dd>`).join('');
      }

      function openPanel(){
        if (window.__ENV_LOCKED__) { window.__toast?.('OTP Ïù∏Ï¶ù ÌõÑ Ïù¥Ïö© Í∞ÄÎä•Ìï©ÎãàÎã§'); return; }
        ['license-panel','contact-panel','otp-panel'].forEach(id=>document.getElementById(id).classList.remove('active'));
        render();
        $panel.style.display = 'block';
      }
      function closePanel(){ $panel.style.display = 'none'; }

      document.getElementById('env-badge').addEventListener('click', () => ($panel.style.display === 'block' ? closePanel() : openPanel()));
      document.getElementById('env-close').addEventListener('click', closePanel);
      document.addEventListener('keydown', e => { if (e.key === 'Escape') closePanel(); });
      document.addEventListener('click', e => { if ($panel.style.display==='block' && !e.target.closest('#env-panel, #env-badge')) closePanel(); });

      ['resize', 'orientationchange', 'online', 'offline'].forEach(evt => window.addEventListener(evt, () => { if ($panel.style.display==='block') render(); }));
      if (navigator.connection && typeof navigator.connection.addEventListener === 'function') {
        navigator.connection.addEventListener('change', () => { if ($panel.style.display==='block') render(); });
      }

      // Ï¥àÍ∏∞ ÎùºÎ≤®
      document.getElementById('env-badge').textContent = deviceTypeLabel();
    })();
  </script>

  <!-- PC: ÌåùÏóÖ(ÌòÑÏû¨ ÌÉ≠ Ïú†ÏßÄ) / Î™®Î∞îÏùº: Í∞ôÏùÄ ÌÉ≠ -->
  <script>
    (function () {
      const POPUP_NAME = 'gameWindow';
      const GAME_URL   = 'game.html';
      const W = 1024, H = 768;

      let lastAttemptFromUser = false;
      let suppressNextHint = false;

      function showPopupHint(msg){
        if (!lastAttemptFromUser || suppressNextHint) return;
        var el = document.getElementById('popup-hint');
        if(!el) return;
        el.textContent = msg || 'ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏñ¥ ÏÉà Ï∞ΩÏùÑ Ïó¥ Ïàò ÏóÜÏäµÎãàÎã§. Ï£ºÏÜåÏ∞Ω Ïö∞Ï∏° ÌåùÏóÖ Ï∞®Îã® ÏïÑÏù¥ÏΩòÏóêÏÑú ÌóàÏö©Ìï¥ Ï£ºÏÑ∏Ïöî.';
        el.style.display = 'block';
        clearTimeout(showPopupHint._t);
        showPopupHint._t = setTimeout(function(){ el.style.display='none'; }, 4000);
      }

      function isDesktop() {
        const ua = navigator.userAgent || '';
        if (navigator.userAgentData && typeof navigator.userAgentData.mobile === 'boolean') {
          return navigator.userAgentData.mobile === false;
        }
        if (/(Mobi|Android|iPhone|iPad|iPod|Windows Phone|BlackBerry)/i.test(ua)) return false;
        const finePointer = window.matchMedia?.('(pointer: fine)')?.matches;
        const canHover    = window.matchMedia?.('(hover: hover)')?.matches;
        if (finePointer && canHover) return true;
        return Math.max(screen.width, screen.height) >= 1024;
      }

      function openGamePopup(url) {
        const left = Math.max(0, Math.round((screen.width  - W) / 2));
        const top  = Math.max(0, Math.round((screen.height - H) / 2));
        const opts = [
          `width=${W}`, `height=${H}`, `left=${left}`, `top=${top}`,
          'resizable=yes','scrollbars=yes','status=no','toolbar=no','menubar=no','noopener','noreferrer'
        ].join(',');
        let win = null;
        try { win = window.open(url, POPUP_NAME, opts); } catch(e) { win = null; }
        return win;
      }

      function shouldUsePopup(){ return isDesktop(); }

      const startBtn = document.getElementById('start-btn');
      if (!startBtn) return;

      startBtn.addEventListener('click', function (e) {
        if (!shouldUsePopup()) return; // Î™®Î∞îÏùº: Í∏∞Î≥∏ Ïù¥Îèô
        e.preventDefault(); // PC: ÌòÑÏû¨ ÌÉ≠ Ïú†ÏßÄ
        lastAttemptFromUser = true;
        suppressNextHint = false;

        const p = openGamePopup(GAME_URL);
        if (!p || p.closed) {
          showPopupHint('ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏñ¥ ÏÉà Ï∞ΩÏùÑ Ïó¥ Ïàò ÏóÜÏäµÎãàÎã§. Î∏åÎùºÏö∞Ï†Ä ÏÑ§Ï†ïÏóêÏÑú ÌóàÏö©Ìï¥Ï£ºÏÑ∏Ïöî.');
        } else {
          try { p.focus(); } catch {}
        }

        setTimeout(()=>{ lastAttemptFromUser = false; }, 0);
      });

      window.addEventListener('message', (e)=>{
        const t = e.data && e.data.type;
        if (t === 'request-close-popup' || t === 'auto-close') {
          suppressNextHint = true;
          setTimeout(()=>{ suppressNextHint = false; }, 1000);
        }
      }, false);
    })();
  </script>

  <!-- ‚úÖ Firebase + OTP(ÏÑúÎ≤Ñ: otp-alpha-ten.vercel.app) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import {
      getAuth, onAuthStateChanged, signInWithEmailAndPassword, signOut,
      GoogleAuthProvider, signInWithPopup
    } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAIrsnUYEBG3cqbPrKD_eejOdtsCDjYG9k",
      authDomain: "siu-studio.firebaseapp.com",
      databaseURL: "https://siu-studio-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "siu-studio",
      storageBucket: "siu-studio.appspot.com",
      messagingSenderId: "830887143444",
      appId: "1:830887143444:web:70b45fc12140e893c31f01",
      measurementId: "G-1Y090YJDB6"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const google = new GoogleAuthProvider();

    // ===== Helpers =====
    const $ = (s)=>document.querySelector(s);
    const toast = (m)=>{
      const el = $("#toast"); el.textContent = m; el.classList.add("show");
      clearTimeout(toast._t); toast._t = setTimeout(()=>el.classList.remove("show"), 1700);
    };
    window.__toast = toast;

    // ===== Lock State =====
    const UNLOCK_KEY = "env_unlock_until";
    function isUnlocked(){ return Date.now() < Number(sessionStorage.getItem(UNLOCK_KEY) || 0); }
    function setUnlocked(minutes=10){
      const until = Date.now() + minutes*60*1000;
      sessionStorage.setItem(UNLOCK_KEY, String(until));
      updateLockUI();
      updateUnlockLeft();
    }
    function updateUnlockLeft(){
      const el = $("#unlock-left");
      const ts = Number(sessionStorage.getItem(UNLOCK_KEY) || 0);
      if (ts > Date.now()){
        const leftMs = ts - Date.now();
        const m = Math.max(0, Math.floor(leftMs/60000));
        const s = Math.max(0, Math.floor((leftMs%60000)/1000));
        el.style.display = "inline";
        el.textContent = `ÎÇ®ÏùÄ ÏãúÍ∞Ñ: ${m}Î∂Ñ ${s}Ï¥à`;
      } else {
        el.style.display = "none";
      }
    }
    setInterval(updateUnlockLeft, 1000);

    // ÌîÑÎ¶¨Î∑∞ Ïû†Í∏à ÏÉÅÌÉú ÌëúÏãú
    function updateLockUI(){
      const locked = !isUnlocked();
      window.__ENV_LOCKED__ = locked;
      const badge = document.getElementById('env-badge');
      if (badge) badge.textContent = (navigator.userAgentData?.mobile ? 'Î™®Î∞îÏùº' : 'PC') + (locked ? ' ¬∑ Ïû†ÍπÄ' : ' ¬∑ Ïó¥Îûå Ï§ë');
      const pv = document.getElementById('env-preview');
      if (pv) pv.classList.toggle('lock', locked);
    }

    // ===== Auth Handlers =====
    $("#btn-google").onclick = async ()=>{
      try{ await signInWithPopup(auth, google); }
      catch(e){ console.error(e); toast("Google Î°úÍ∑∏Ïù∏ Ïã§Ìå®"); }
    };
    $("#btn-email-login").onclick = async ()=>{
      const email = $("#email").value.trim(); const pw = $("#pw").value;
      if(!email || !pw) return toast("Ïù¥Î©îÏùº/ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî");
      try{ await signInWithEmailAndPassword(auth, email, pw); }
      catch(e){ console.error(e); toast("Ïù¥Î©îÏùº Î°úÍ∑∏Ïù∏ Ïã§Ìå®"); }
    };
    $("#btn-logout").onclick = async ()=>{
      try{ await signOut(auth); sessionStorage.removeItem(UNLOCK_KEY); toast("Î°úÍ∑∏ÏïÑÏõÉ ÏôÑÎ£å"); }
      catch(e){ console.error(e); toast("Î°úÍ∑∏ÏïÑÏõÉ Ïã§Ìå®"); }
      updateAuthUI();
      updateLockUI();
    };

    function deviceTypeLabel(){ 
      const ua = navigator.userAgent || "";
      const touch = ("ontouchstart" in window) || (navigator.maxTouchPoints>0);
      const small = Math.max(screen.width, screen.height) < 1024;
      const mobUA = /(Mobi|Android|iPhone|iPad|iPod|Windows Phone|BlackBerry)/i.test(ua);
      return (mobUA || (touch && small)) ? "Î™®Î∞îÏùº" : "PC";
    }

    function updateAuthUI(){
      const user = auth.currentUser;
      $("#auth-state").textContent = user ? `${user.email || "(Ïù¥Î©îÏùº ÏóÜÏùå)"} Î°úÍ∑∏Ïù∏Îê®` : "ÎπÑÎ°úÍ∑∏Ïù∏";
      const badge = document.getElementById('device-badge');
      if (badge) badge.textContent = deviceTypeLabel();
    }

    onAuthStateChanged(auth, ()=>{ updateAuthUI(); updateLockUI(); });

    // ===== OTP API =====
    const API_BASE = "https://otp-alpha-ten.vercel.app"; // üîó Î∞∞Ìè¨Ìïú Vercel ÎèÑÎ©îÏù∏
    $("#btn-send").onclick = async ()=>{
      const user = auth.currentUser;
      if(!user) return toast("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©ÌïòÏÑ∏Ïöî");
      try{
        const idToken = await user.getIdToken();
        const r = await fetch(`${API_BASE}/api/send-otp`, {
          method:"POST",
          headers:{ "Authorization": `Bearer ${idToken}` }
        });
        const j = await r.json().catch(()=>null);
        if(!r.ok || !j?.ok){
          const err = j?.error || r.status;
          if (err === "TOO_SOON") return toast("Ïû¨Ï†ÑÏÜ°ÏùÄ Ïû†Ïãú ÌõÑÏóê Í∞ÄÎä•Ìï©ÎãàÎã§(Ïø®Îã§Ïö¥).");
          if (err === "NO_EMAIL_ON_ACCOUNT") return toast("Í≥ÑÏ†ïÏóê Ïù¥Î©îÏùºÏù¥ ÏóÜÏäµÎãàÎã§.");
          return toast("Ï†ÑÏÜ° Ïã§Ìå®: "+err);
        }
        toast("Ïù∏Ï¶ùÎ≤àÌò∏Î•º Ïù¥Î©îÏùºÎ°ú Î≥¥ÎÉàÏäµÎãàÎã§(5Î∂Ñ Ïú†Ìö®)");
      }catch(e){ console.error(e); toast("Ï†ÑÏÜ° Ï§ë Ïò§Î•ò"); }
    };

    $("#btn-verify").onclick = async ()=>{
      const code = $("#otp-code").value.trim();
      if(!/^\d{6}$/.test(code)) return toast("6ÏûêÎ¶¨ Ïà´Ïûê ÏΩîÎìúÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî");
      const user = auth.currentUser;
      if(!user) return toast("Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©ÌïòÏÑ∏Ïöî");
      try{
        const idToken = await user.getIdToken();
        const r = await fetch(`${API_BASE}/api/verify-otp`, {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ idToken, code })
        });
        const j = await r.json().catch(()=>null);
        if(!r.ok || !j?.ok){
          const err = j?.error || r.status;
          if (err === "EXPIRED") return toast("ÏΩîÎìúÍ∞Ä ÎßåÎ£åÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú Ï†ÑÏÜ°ÌïòÏÑ∏Ïöî.");
          if (err === "INVALID_CODE") return toast("ÏΩîÎìúÍ∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.");
          if (err === "TOO_MANY_ATTEMPTS") return toast("ÏãúÎèÑ ÌöüÏàò Ï¥àÍ≥º. Îã§Ïãú Ï†ÑÏÜ°ÌïòÏÑ∏Ïöî.");
          return toast("Í≤ÄÏ¶ù Ïã§Ìå®: "+err);
        }
        setUnlocked(j.unlockMinutes || 10);
        toast("Ïù∏Ï¶ù ÏÑ±Í≥µ! 10Î∂Ñ ÎèôÏïà Ïó¥Îûå Í∞ÄÎä•");
        document.getElementById('otp-panel').classList.remove('active');
      }catch(e){ console.error(e); toast("Í≤ÄÏ¶ù Ï§ë Ïò§Î•ò"); }
    };

    // ===== Ï¥àÍ∏∞ ÌîÑÎ¶¨Î∑∞/Î∞∞ÏßÄ =====
    (function initPreview(){
      const pv = document.createElement('div');
      pv.id = 'env-preview';
      pv.className = 'lock';
      pv.style.cssText = 'position:absolute;left:10px;bottom:10px;color:#fff;font-size:12px;opacity:.9';
      pv.innerHTML = `
        <div>ÎîîÎ∞îÏù¥Ïä§: <span id="pv-device">${deviceTypeLabel()}</span></div>
        <div>Î∏åÎùºÏö∞Ï†Ä: <span id="pv-ua">${navigator.userAgent || '-'}</span></div>
        <div>ÎÑ§Ìä∏ÏõåÌÅ¨: <span id="pv-net">-</span></div>
      `;
      document.querySelector('.content').appendChild(pv);

      const c = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
      document.getElementById('pv-net').textContent = c ? (c.effectiveType || c.type || 'ÏïåÏàòÏóÜÏùå') : '(API ÎØ∏ÏßÄÏõê)';
      updateLockUI();
    })();
  </script>

  <!-- ÎîîÎ≤ÑÍ∑∏ Ï∞®Îã®(ÏòµÏÖò) -->
  <script src="https://cdn.jsdelivr.net/npm/disable-devtool@latest"></script>
  <script>
    DisableDevtool({
      disableMenu: true,
      disableSelect: true,
      disableCopy: true,
      disableCut: true,
      disablePaste: true,
      clearIntervalWhenDevOpenTrigger: true,
      ondevtoolopen(type, next) { /* window.close(); */ next(); },
      ondevtoolclose() { console.warn('DevTools Îã´Ìûò Í∞êÏßÄÎê®'); }
    });
    // Ïö∞ÌÅ¥Î¶≠ Ï∞®Îã® (ÏûÖÎ†• ÏòÅÏó≠ ÌóàÏö©)
    document.addEventListener('contextmenu', function (e) {
      if (e.target.closest('input, textarea, [contenteditable="true"]')) return;
      e.preventDefault();
    });
  </script>

  <!-- ÌåùÏóÖÏúºÎ°ú Ïó¥Î†∏ÏùÑ Îïå ÏûêÎèô Ï¢ÖÎ£å -->
  <script>
    (function() {
      try {
        const openedByScript = !!window.opener;
        if (openedByScript) {
          const CLOSE_DELAY_MS = 500;
          setTimeout(() => {
            try { window.opener.postMessage && window.opener.postMessage({ type: 'auto-close', from: location.href }, '*'); } catch (e) {}
            try { window.close(); } catch (e) {}
            setTimeout(() => {
              try { window.location.href = 'about:blank'; } catch (e) {}
              try { window.close(); } catch (e) {}
            }, 50);
          }, CLOSE_DELAY_MS);
        }
      } catch (e) {
        console.warn('ÌåùÏóÖ ÏûêÎèô Ï¢ÖÎ£å Í≤ÄÏÇ¨ Ï§ë Ïò§Î•ò:', e);
      }
    })();
  </script>
</body>
</html>
